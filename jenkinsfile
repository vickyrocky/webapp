node{
    
    //properties([pipelineTriggers([githubPush()])])
    stage('Checkout source code:'){
        
        git 'https://github.com/vickyrocky/webapp.git'
    }
    stage('Build:'){
        def mavenHome=tool name: 'maven', type: 'maven'
        sh "${mavenHome}/bin/mvn -B -DskipTests clean package"
        
    }
    stage('Junit Test:'){
        
        def mavenHome=tool name: 'maven', type: 'maven'
        sh "${mavenHome}/bin/mvn test"
    }
    stage('SonarQube analysis:'){
        
        def scannerHome =  tool name: 'scanner'
        withSonarQubeEnv('sonarqube_test') {
            sh "${scannerHome}/bin/sonar-scanner " +
                "-Dsonar.projectKey=webapp " +
                "-Dsonar.sources=. " +
                "-Dsonar.java.binaries=. "
                
            
        }
    }
    stage('Deploy:'){
        
    
        
    }
    
}
